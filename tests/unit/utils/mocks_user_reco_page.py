from pyspark.sql import SparkSession
import pandas as pd
from datetime import datetime, timedelta

spark = SparkSession.builder.getOrCreate()

today = datetime.today()

fact_watch_sdf_mock = spark.createDataFrame(pd.DataFrame([
    {"USER_ID": 1, "PROGRAM_ID": 4, 'DATE': datetime.today() - timedelta(days=1)},
    {"USER_ID": 1, "PROGRAM_ID": 5, 'DATE': datetime.today() - timedelta(days=2)},
    {"USER_ID": 1, "PROGRAM_ID": 6, 'DATE': datetime.today() - timedelta(days=3)},
    {"USER_ID": 1, "PROGRAM_ID": 30, 'DATE': datetime.today() - timedelta(days=4)},
    {"USER_ID": 1, "PROGRAM_ID": 21, 'DATE': datetime.today() - timedelta(days=5)},
    {"USER_ID": 2, "PROGRAM_ID": 4, 'DATE': datetime.today() - timedelta(days=1)},
    {"USER_ID": 2, "PROGRAM_ID": 5, 'DATE': datetime.today() - timedelta(days=2)},
    {"USER_ID": 2, "PROGRAM_ID": 6, 'DATE': datetime.today() - timedelta(days=3)},
    {"USER_ID": 2, "PROGRAM_ID": 30, 'DATE': datetime.today() - timedelta(days=4)},
    {"USER_ID": 2, "PROGRAM_ID": 21, 'DATE': datetime.today() - timedelta(days=5)},

]))

available_programs_sdf_mock = spark.createDataFrame(
    pd.DataFrame({"PROGRAM_ID": list(range(4, 50))}))

similarity_table_sdf_mock = spark.createDataFrame(pd.DataFrame([
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 3, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 5, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 3, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 10, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 11, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 22, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 3, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 10, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 22, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 6, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 3, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 5, 'PROGRAM_ID_J': 1, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 3, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 10, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 11, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 20, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 22, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 3, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 10, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 1, 'PROGRAM_ID_J': 20, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 1.0},
    {'PROGRAM_ID_I': 22, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.9},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 6, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.7},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 6, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 6, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 3, 'SIMILARITY_SCORE': 0.5},
    {'PROGRAM_ID_I': 3, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.5},
    {'PROGRAM_ID_I': 5, 'PROGRAM_ID_J': 22, 'SIMILARITY_SCORE': 0.3},
    {'PROGRAM_ID_I': 22, 'PROGRAM_ID_J': 5, 'SIMILARITY_SCORE': 0.2},
    {'PROGRAM_ID_I': 6, 'PROGRAM_ID_J': 2, 'SIMILARITY_SCORE': 0.1},
    {'PROGRAM_ID_I': 2, 'PROGRAM_ID_J': 6, 'SIMILARITY_SCORE': 0.2},
    {'PROGRAM_ID_I': 6, 'PROGRAM_ID_J': 7, 'SIMILARITY_SCORE': 0.3},
    {'PROGRAM_ID_I': 7, 'PROGRAM_ID_J': 6, 'SIMILARITY_SCORE': 0.4},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 7, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 7, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.5},
    {'PROGRAM_ID_I': 30, 'PROGRAM_ID_J': 16, 'SIMILARITY_SCORE': 0.4},
    {'PROGRAM_ID_I': 16, 'PROGRAM_ID_J': 30, 'SIMILARITY_SCORE': 0.3},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 23, 'SIMILARITY_SCORE': 0.2},
    {'PROGRAM_ID_I': 23, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.1},
    {'PROGRAM_ID_I': 21, 'PROGRAM_ID_J': 24, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 24, 'PROGRAM_ID_J': 21, 'SIMILARITY_SCORE': 0.6},
    {'PROGRAM_ID_I': 4, 'PROGRAM_ID_J': 8, 'SIMILARITY_SCORE': 0.8},
    {'PROGRAM_ID_I': 8, 'PROGRAM_ID_J': 4, 'SIMILARITY_SCORE': 0.6},

]))

procesed_pdf = pd.DataFrame([
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 19973, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 329451, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 28471, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 39738, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 11582, 'FINAL_SIM_RANK': 5,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 286980, 'FINAL_SIM_RANK': 6,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 296851, 'FINAL_SIM_RANK': 7,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 333422, 'FINAL_SIM_RANK': 8,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 56736, 'FINAL_SIM_RANK': 9,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 210060, 'FINAL_SIM_RANK': 10,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423243, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1424265, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423984, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1122, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 48407, 'FINAL_SIM_RANK': 5,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 303, 'FINAL_SIM_RANK': 6,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1424129, 'FINAL_SIM_RANK': 7,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423578, 'FINAL_SIM_RANK': 8,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423742, 'FINAL_SIM_RANK': 9,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423428, 'FINAL_SIM_RANK': 10,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 756, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 1314, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 676, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 17110149, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 138784, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 19973, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 329451, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 28471, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 39738, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 11582, 'FINAL_SIM_RANK': 5,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 286980, 'FINAL_SIM_RANK': 6,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 296851, 'FINAL_SIM_RANK': 7,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 333422, 'FINAL_SIM_RANK': 8,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 56736, 'FINAL_SIM_RANK': 9,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 32163, 'PROGRAM_ID_J': 210060, 'FINAL_SIM_RANK': 10,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423243, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1424265, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423984, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1122, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 48407, 'FINAL_SIM_RANK': 5,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 303, 'FINAL_SIM_RANK': 6,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1424129, 'FINAL_SIM_RANK': 7,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423578, 'FINAL_SIM_RANK': 8,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423742, 'FINAL_SIM_RANK': 9,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 10116, 'PROGRAM_ID_J': 1423428, 'FINAL_SIM_RANK': 10,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 756, 'FINAL_SIM_RANK': 1,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 1314, 'FINAL_SIM_RANK': 2,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 676, 'FINAL_SIM_RANK': 3,
     'PROG_RANK': 1},
    {'USER_ID': 2, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 43642, 'PROGRAM_ID_J': 138784, 'FINAL_SIM_RANK': 4,
     'PROG_RANK': 1},
])

procesed_sdf = spark.createDataFrame(procesed_pdf)

procesed_pdf_2 = pd.DataFrame([
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 158478,
     'SIM_RANK': 1, 'FINAL_SIM_RANK': 1, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 158740,
     'SIM_RANK': 2, 'FINAL_SIM_RANK': 2, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 28707,
     'SIM_RANK': 3, 'FINAL_SIM_RANK': 3, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 10001,
     'SIM_RANK': 4, 'FINAL_SIM_RANK': 4, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 11151,
     'SIM_RANK': 5, 'FINAL_SIM_RANK': 5, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 279014,
     'SIM_RANK': 6, 'FINAL_SIM_RANK': 6, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 279015,
     'SIM_RANK': 7, 'FINAL_SIM_RANK': 7, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 26100,
     'SIM_RANK': 8, 'FINAL_SIM_RANK': 8, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 1, 'FINAL_DATE_RANK': 1, 'PROGRAM_ID_I': 158230, 'PROGRAM_ID_J': 26731,
     'SIM_RANK': 9, 'FINAL_SIM_RANK': 9, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 756,
     'SIM_RANK': 1, 'FINAL_SIM_RANK': 1, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 1319,
     'SIM_RANK': 2, 'FINAL_SIM_RANK': 2, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 25608,
     'SIM_RANK': 3, 'FINAL_SIM_RANK': 3, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 43525,
     'SIM_RANK': 4, 'FINAL_SIM_RANK': 4, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 1317,
     'SIM_RANK': 5, 'FINAL_SIM_RANK': 5, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 1313,
     'SIM_RANK': 6, 'FINAL_SIM_RANK': 6, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 1314,
     'SIM_RANK': 7, 'FINAL_SIM_RANK': 7, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 303,
     'SIM_RANK': 8, 'FINAL_SIM_RANK': 8, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 2, 'FINAL_DATE_RANK': 2, 'PROGRAM_ID_I': 2977, 'PROGRAM_ID_J': 43642,
     'SIM_RANK': 9, 'FINAL_SIM_RANK': 9, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 293, 'SIM_RANK': 1,
     'FINAL_SIM_RANK': 1, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 41730,
     'SIM_RANK': 19, 'FINAL_SIM_RANK': 2, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 43758,
     'SIM_RANK': 23, 'FINAL_SIM_RANK': 3, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 125,
     'SIM_RANK': 30, 'FINAL_SIM_RANK': 4, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 276,
     'SIM_RANK': 31, 'FINAL_SIM_RANK': 5, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 1232,
     'SIM_RANK': 32, 'FINAL_SIM_RANK': 6, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 808,
     'SIM_RANK': 33, 'FINAL_SIM_RANK': 7, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 18918,
     'SIM_RANK': 35, 'FINAL_SIM_RANK': 8, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 4, 'FINAL_DATE_RANK': 3, 'PROGRAM_ID_I': 464, 'PROGRAM_ID_J': 5428,
     'SIM_RANK': 36, 'FINAL_SIM_RANK': 9, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 37926,
     'SIM_RANK': 1, 'FINAL_SIM_RANK': 1, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 2462,
     'SIM_RANK': 2, 'FINAL_SIM_RANK': 2, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 6085,
     'SIM_RANK': 4, 'FINAL_SIM_RANK': 3, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 2055,
     'SIM_RANK': 5, 'FINAL_SIM_RANK': 4, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 7187,
     'SIM_RANK': 6, 'FINAL_SIM_RANK': 5, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 240490,
     'SIM_RANK': 7, 'FINAL_SIM_RANK': 6, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 39390,
     'SIM_RANK': 8, 'FINAL_SIM_RANK': 7, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 9350,
     'SIM_RANK': 10, 'FINAL_SIM_RANK': 8, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 5, 'FINAL_DATE_RANK': 4, 'PROGRAM_ID_I': 521, 'PROGRAM_ID_J': 4994,
     'SIM_RANK': 11, 'FINAL_SIM_RANK': 9, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 339961,
     'SIM_RANK': 1, 'FINAL_SIM_RANK': 1, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 258201,
     'SIM_RANK': 2, 'FINAL_SIM_RANK': 2, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 20323,
     'SIM_RANK': 3, 'FINAL_SIM_RANK': 3, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 146916,
     'SIM_RANK': 4, 'FINAL_SIM_RANK': 4, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 52448,
     'SIM_RANK': 5, 'FINAL_SIM_RANK': 5, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 341165,
     'SIM_RANK': 6, 'FINAL_SIM_RANK': 6, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 330716,
     'SIM_RANK': 7, 'FINAL_SIM_RANK': 7, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 36284,
     'SIM_RANK': 8, 'FINAL_SIM_RANK': 8, 'PROG_RANK': 1},
    {'USER_ID': 11874590, 'DATE_RANK': 6, 'FINAL_DATE_RANK': 5, 'PROGRAM_ID_I': 343383, 'PROGRAM_ID_J': 262201,
     'SIM_RANK': 9, 'FINAL_SIM_RANK': 9, 'PROG_RANK': 1},
])

procesed_sdf_2 = spark.createDataFrame(procesed_pdf_2)
